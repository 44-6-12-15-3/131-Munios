#include <iostream>

class Weapon {
public:
    virtual void Attack() = 0;
    virtual ~Weapon() = default;
};

class MagicWeapon : public Weapon {
    int physicalDamage;
    int magicDamage;
    
public:
    MagicWeapon(int physDmg, int magDmg) : physicalDamage(physDmg), magicDamage(magDmg) {}
    
    void Attack() override {
        std::cout << "Атакуем магическим оружием" << std::endl;
        std::cout << "Физический урон: " << physicalDamage << std::endl;
        std::cout << "Магический урон: " << magicDamage << std::endl;
        std::cout << "Общий урон: " << (physicalDamage + magicDamage) << std::endl;
    }
    
    int getPhysicalDamage() const { return physicalDamage; }
    int getMagicDamage() const { return magicDamage; }
    int getTotalDamage() const { return physicalDamage + magicDamage; }
    
    void setPhysicalDamage(int dmg) { physicalDamage = dmg; }
    void setMagicDamage(int dmg) { magicDamage = dmg; }
};

class DisposableWeapon : public Weapon {
    bool used;
    
public:
    DisposableWeapon() : used(false) {}
    
    void Attack() override {
        if (used) {
            std::cout << "Оружие уже было использовано" << std::endl;
        } else {
            std::cout << "Атакуем одноразовым оружием" << std::endl;
            used = true;
        }
    }
    
    void reset() {
        used = false;
    }
};

template<typename TLeft, typename TRight>
class DualWeapons {
    TLeft leftWeapon;
    TRight rightWeapon;
    
public:
    DualWeapons(const TLeft& left, const TRight& right) 
        : leftWeapon(left), rightWeapon(right) {}
    
    TLeft getLeftWeapon() const {
        return leftWeapon;
    }
    
    TRight getRightWeapon() const {
        return rightWeapon;
    }
    
    void setLeftWeapon(const TLeft& weapon) {
        leftWeapon = weapon;
    }
    
    void setRightWeapon(const TRight& weapon) {
        rightWeapon = weapon;
    }
    
    void AttackWithBoth() {
        std::cout << "=== Атака двумя руками ===" << std::endl;
        
        std::cout << "ЛЕВАЯ РУКА:" << std::endl;
        if constexpr (std::is_base_of<Weapon, TLeft>::value) {
            leftWeapon.Attack();
        } else {
            std::cout << "Оружие ID: " << leftWeapon << std::endl;
        }
        
        std::cout << "\nПРАВАЯ РУКА:" << std::endl;
        if constexpr (std::is_base_of<Weapon, TRight>::value) {
            rightWeapon.Attack();
        } else {
            std::cout << "Оружие ID: " << rightWeapon << std::endl;
        }
        std::cout << "==========================" << std::endl;
    }
};

int main() {
    MagicWeapon magicWand(15, 25);
    std::cout << "Магическое оружие:" << std::endl;
    magicWand.Attack();
    
    std::cout << "\nИнформация о магическом оружии:" << std::endl;
    std::cout << "Физический урон: " << magicWand.getPhysicalDamage() << std::endl;
    std::cout << "Магический урон: " << magicWand.getMagicDamage() << std::endl;
    std::cout << "Общий урон: " << magicWand.getTotalDamage() << std::endl;
    
    std::cout << "\nОдноразовое оружие:" << std::endl;
    
    DisposableWeapon throwingKnife;
    
    throwingKnife.Attack();
    throwingKnife.Attack();
    
    std::cout << "\nТестирование шаблона DualWeapons:" << std::endl;
    
    MagicWeapon leftMagic(10, 30);
    DisposableWeapon rightDisposable;
    DualWeapons<MagicWeapon, DisposableWeapon> dual1(leftMagic, rightDisposable);
    
    std::cout << "Двойное оружие (типы оружия):" << std::endl;
    dual1.AttackWithBoth();
    
    std::cout << "\nПовторная атака двойным оружием:" << std::endl;
    dual1.AttackWithBoth();
    
    int leftId = 1001;
    int rightId = 1002;
    DualWeapons<int, int> dual2(leftId, rightId);
    
    std::cout << "\nДвойное оружие (ID оружия):" << std::endl;
    dual2.AttackWithBoth();
    
    std::cout << "\nДемонстрация GET/SET методов:" << std::endl;
    
    std::cout << "Левый ID: " << dual2.getLeftWeapon() << std::endl;
    std::cout << "Правый ID: " << dual2.getRightWeapon() << std::endl;
    
    dual2.setLeftWeapon(2001);
    dual2.setRightWeapon(2002);
    
    std::cout << "После изменения:" << std::endl;
    dual2.AttackWithBoth();
    
    std::cout << "\nРазные комбинации оружия:" << std::endl;
    
    MagicWeapon fireStaff(5, 40);
    DualWeapons<MagicWeapon, int> dual3(fireStaff, 3001);
    dual3.AttackWithBoth();
    
    DisposableWeapon poisonDart;
    DualWeapons<int, DisposableWeapon> dual4(4001, poisonDart);
    dual4.AttackWithBoth();
    
    return 0;
}
